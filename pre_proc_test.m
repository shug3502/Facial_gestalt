function [ proc_image ] = pre_proc_test( img, landmarks, debug_flag)

basePts = [-0.344449871554326,-0.286140610639243,-0.206291605361837,-0.123165429505265, 0.102061089110894, 0.180435206351474, 0.257824036262126, 0.313957570026701,-0.273608464749917,-0.197614966903547,-0.114976905002767,-0.195533041239132, 0.102893784415597, 0.183354107238856, 0.257683898414977, 0.185268911981439,-0.00499878064731847,-0.00600373217438954,-0.113623864064850,-0.0773175949737450,-0.00562638804746350,0.0606779489471228,0.100277827723766,-0.157544293979341,-0.0390253070456366,-0.00357988829375728,0.0292253357082362,0.150068417096787,-0.00290790188129631,-0.419577310045621,-0.334107597165003,-0.106345135717737,0.00411451700576350,0.102693852068015,0.327575004762424, 0.395572118594361; -0.245834268805794,-0.288465079546746,-0.297675456942479,-0.281406424187750,-0.282011901028994,-0.301240038169033,-0.295298144909642,-0.260343809803420,-0.171538431806092,-0.209125590922474,-0.170754908312346,-0.148578112300366,-0.172901133584621,-0.211650824116470,-0.176331362551717,-0.151956967726627,-0.248693225793379, -0.00465796441684481, 0.0148184459402330,0.0384590394203731, 0.0501143049304333, 0.0394208780054477,0.0135173315730341,0.162711333418089, 0.127624050467519, 0.135858935798974,   0.127241322204543, 0.158220624748074, 0.251689278987065,  -0.108182172182936, 0.213122954127730, 0.392765827732234,0.416257993739587, 0.389052256889704,0.198334027713423,-0.112914703892629];

% ratios
x0 = -0.52;
x1 = 0.52;
y0 = -0.65;
y1 = 0.5;

% scale
scale = 125;

basePts = basePts * scale;
x0 = x0 * scale;
x1 = x1 * scale;
y0 = y0 * scale;
y1 = y1 * scale;

% compute alignment transform
tform = cp2tform(landmarks, basePts', 'similarity');

% apply transform and do crop
proc_image = imtransform(img, tform, 'bicubic', 'XData', [x0 x1], ...
'YData', [y0 y1], 'XYScale', 1);

if size(proc_image,3)==3
     proc_image = rgb2gray(proc_image);
end

if debug_flag
     subplot(1,2,1)
     imshow(img)
     subplot(1,2,2)
     imshow(proc_image)
end
end